


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>  Mysql3 |    Fly_cloud</title>
  <meta name="description" content="A minimalist theme for hexo.">
  <!-- 标签页图标 -->
  

  <!-- 图标库 -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
  <!-- 动画库 -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fushaolei/cdn-white@1.0/css/animate.css"/>
  
  <!-- css文件 -->
  
<link rel="stylesheet" href="/GaoHangIdea/css/white.css">

  <!-- 代码高亮 -->
  
    
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.1.1/styles/github.css">

    
  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>

<div class="menu-outer">
    <div class="menu-inner">
      <div class="menu-site-name  animate__animated  animate__fadeInUp">
        <a href="/GaoHangIdea/">
          Fly_cloud
        </a>
        
      </div>
      <div class="menu-group">
        <ul class="menu-ul">
        
          <a href="/GaoHangIdea/" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              HOME
            </li>
          </a>
        
          <a href="/GaoHangIdea/archives" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              BLOG
            </li>
          </a>
        
          <a href="/GaoHangIdea/tags" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              TAGS
            </li>
          </a>
        
        
          <li class="menu-li animate__animated  animate__fadeInUp" id="sort">
             分类
             <div class="categories-outer " id="sort-div">
               <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/GaoHangIdea/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/GaoHangIdea/categories/Vue/">Vue</a></li><li class="category-list-item"><a class="category-list-link" href="/GaoHangIdea/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li></ul>
             </div>
          </li>
        
        
          <li class="menu-li animate__animated  animate__fadeInUp" id="mobile-menu">
            <i class="ri-menu-line"></i>
          </li>
        
        </ul>

      </div>

    </div>
</div>
<div id="mobile-main" class="animate__animated  animate__fadeIn">
  <div class="mobile-menu-inner">
    <div class="mobile-menu-site-name animate__animated  animate__fadeInUp">
      <a href="/GaoHangIdea/">
        Fly_cloud
      </a>
    </div>
    <div class="mobile-menu-group" id="mobile-close">
      <i class="ri-close-line"></i>
    </div>

  </div>

  <div class="mobile-menu-div">
  
    <a href="/GaoHangIdea/" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>HOME</span>
      </div>
    </a>
  
    <a href="/GaoHangIdea/archives" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>BLOG</span>
      </div>
    </a>
  
    <a href="/GaoHangIdea/tags" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>TAGS</span>
      </div>
    </a>
  
  
  </div>


</div>

<div class="body-outer">
  <div class="body-inner">
    
<article class="post-inner">
  <div class="post-content-outer">
    <div class="post-intro">
      <div class="post-title animate__animated  animate__fadeInUp">Mysql3</div>
      <div class="meta-intro animate__animated  animate__fadeInUp">Oct 19 2022</div>
      
    </div>
    <div class="post-content-inner">
      <div class="post-content-inner-space">

      </div>
      <div class="post-content-main animate__animated  animate__fadeInUp">
        <!-- top型目录 -->
        
        <h1 id="Mysql-days03"><a href="#Mysql-days03" class="headerlink" title="Mysql days03"></a>Mysql days03</h1><p>1、约束</p>
<p>1.1、唯一性约束(unique)</p>
<ul>
<li><p>唯一性约束修饰的字段具有唯一性，不能重复。但可以为null。</p>
</li>
<li><p>案例：给某一列添加unique<br>  drop table if exists t_user;<br>  create table t_user(<br>id int,<br>username varchar(255) unique  &#x2F;&#x2F;列级约束<br>);<br>insert into t_user values(1,’zhangsan’);		<br>insert into t_user values(2,’zhangsan’);  &#x2F;&#x2F;出现编译错误，唯一性约束，该字段与上一行字段重复，但可以为null！<br>ERROR 1062 (23000) : Duplicate entry ‘zhangsan’ for key ‘username’</p>
<p>insert into t_user(id) values(2);<br>insert into t_user(id) values(3);<br>insert into t_user(id) values(4);<br>*案例：给两个列或者多个列添加unique<br>drop table if exists t_user;<br>create table t_user(<br>id int,<br>usercode varchar(255),<br>username varchar(255),<br>unique(usercode,username)  &#x2F;&#x2F;多个字段联合起来添加一个约束unique 【表级约束】<br>   );</p>
<p> insert into t_user values(1,’111’,’zs’);<br> insert into t_user values(2,’111’,’ls’);<br> insert into t_user values(3,’222’,’zs’);<br> select * from t_user;<br> insert into t_user values(4,’111’,’zs’);  &#x2F;&#x2F;出现编译错误！<br> ERROR 1062 (23000) : Duplicate entry ‘111-zs’ for key ‘usercode’</p>
<p> drop table if exists t_user;<br> create table t_suer(<br> id int,<br> usercode varchar(255) unique,<br> username varchar(255) unique<br>   );<br> insert into t_user values(1,’111’,’zs’);<br> insert into t_user values(2,’111’,’ls’);<br> ERROR 1062 (23000) : Duplicate entry ‘111’ for key ‘usercode’</p>
</li>
<li><p>注意：not null约束只有列级约束，没有表级约束。</p>
</li>
</ul>
<p>1.2、主键约束</p>
<ul>
<li><p>怎么给一张表添加主键约束呢？<br>  drop table if exists t_user;<br>  create table t_user(<br>  id int primary key,  &#x2F;&#x2F;列级约束<br>  username varchar(255),<br>  email varchar(255)<br>  );<br>  insert into t_user(id,username,email) values(1,’zs’,‘<a href="mailto:&#x7a;&#x73;&#x40;&#49;&#x32;&#51;&#x2e;&#99;&#x6f;&#x6d;">&#x7a;&#x73;&#x40;&#49;&#x32;&#51;&#x2e;&#99;&#x6f;&#x6d;</a>‘);<br>  insert into t_user(id,username,email) values(2,’ls’,‘<a href="mailto:&#108;&#115;&#x40;&#x31;&#50;&#x33;&#x2e;&#99;&#x6f;&#x6d;">&#108;&#115;&#x40;&#x31;&#50;&#x33;&#x2e;&#99;&#x6f;&#x6d;</a>‘);<br>  insert into t_user(id,username,email) values(3,’ww’,‘<a href="mailto:&#x77;&#x77;&#x40;&#x31;&#x32;&#x33;&#x2e;&#x63;&#x6f;&#109;">&#x77;&#x77;&#x40;&#x31;&#x32;&#x33;&#x2e;&#x63;&#x6f;&#109;</a>‘);<br>  select * from t_user;<br>  +—————————–+<br>  | id | username | email       |<br>  +—————————–+<br>  |  1 | zs       | <a href="mailto:&#122;&#115;&#64;&#x31;&#50;&#51;&#46;&#99;&#111;&#x6d;">&#122;&#115;&#64;&#x31;&#50;&#51;&#46;&#99;&#111;&#x6d;</a>  |<br>  |  2 | ls       | <a href="mailto:&#108;&#x73;&#x40;&#49;&#50;&#x33;&#x2e;&#99;&#111;&#109;">&#108;&#x73;&#x40;&#49;&#50;&#x33;&#x2e;&#99;&#111;&#109;</a>  |<br>  |  3 | ww       | <a href="mailto:&#x77;&#x77;&#x40;&#49;&#50;&#x33;&#46;&#99;&#111;&#109;">&#x77;&#x77;&#x40;&#49;&#50;&#x33;&#46;&#99;&#111;&#109;</a>  |<br>  +—-+———-+————-+</p>
<p>  insert into t_user(id,username,email) values(1,’jack’,‘<a href="mailto:&#x6a;&#x61;&#99;&#x6b;&#64;&#49;&#x32;&#x33;&#46;&#99;&#x6f;&#109;">&#x6a;&#x61;&#99;&#x6b;&#64;&#49;&#x32;&#x33;&#46;&#99;&#x6f;&#109;</a>‘);  &#x2F;&#x2F;出现编译错误，主键约束，不能为null也不能重复！<br>  ERROR 1364 (HY000) : Field ‘id’ doesn’t have a default value</p>
<p>  根据以上的测试得出：id是主键，因为添加了主键约束，主键字段中的数据不能为null，也不能重复。<br>  主键的特点：不能为null，也不能重复。</p>
</li>
<li><p>主键相关的术语？<br>  主键约束 ：primary key<br>  主键字段 : id字段添加primary key之后，id叫做主键字段<br>  主键值 ：id字段中的每一个值都是主键值。</p>
</li>
<li><p>主键有什么作用？<br>  根据主键字段的字段数量来划分：<br>  单一主键 (推荐的，常用的。)<br>  复合主键(多个字段联合起来添加一个主键约束) (复合主键不建议使用，因为复合主键违背三范式。)<br>  根据主键性质来划分：<br>  自然主键 ：主键值最好就是一个和业务没有任何关系的自然数。(这种方式是推荐的)<br>  业务主键 : 主键值和系统的业务挂钩，例如：拿着银行卡的卡号做主键、拿着身份证号做为主键。(不推荐使用)<br>         最好不要拿着和业务挂钩的字段做为主键。因为以后的业务一旦发生改变的时候，主键也可能需要随着<br>     发生变化，但有的时候没有办法变化，因为变化可能会导致主键重复。</p>
</li>
<li><p>一张表的主键约束只能有1个。(必须记住)</p>
</li>
<li><p>使用表级约束方式定义主键：<br>  drop table if exists t_user;<br>  create table t_user(<br>  id int,<br>  username varchar(255),<br>  primary key(id)<br>);<br>insert into t_user(id,username) values(1,’zs’);<br>insert into t_user(id,username) values(2,’ls’);<br>insert into t_user(id,username) values(3,’ws’);<br>insert into t_user(id,username) values(4,’cs’);<br>select * from t_user;</p>
<p>insert into t_user(id,username) values(3,’cx’);  &#x2F;&#x2F;出现编译错误！<br>ERROR 1062 (23000) : Duplicate entry ‘4’ for key ‘PRIMARY’</p>
<p>以下内容是演示一下复合主键，不需要掌握：<br>drop table if exists t_user;<br>create table t_user(<br>    id int,<br>username varchar(255),<br>password varchar(255),<br>primary key(id,username)<br> );<br>insert ……</p>
</li>
<li><p>mysql提供主键值自增：(非常重要。)<br>  drop table if exists t_user;<br>  create table t_user(<br>  id int primary key auto_increment,  &#x2F;&#x2F;id字段自动维护一个自增的数字，从1开始，以1递增。<br>  username varchar(255)<br>);<br>  insert into t_user(username) values(‘a’);<br>  insert into t_user(username) values(‘b’);<br>  insert into t_user(username) values(‘c’);<br>  insert into t_user(username) values(‘d’);<br>  insert into t_user(username) values(‘e’);<br>  insert into t_user(username) values(‘f’);<br>  select * from t_user;</p>
<p>  提示：Oracle当中也提供了一个自增机制，叫做：序列(sequence)对象。</p>
</li>
</ul>
<p>1.3、外键约束</p>
<ul>
<li><p>关于外键约束的相关术语：<br>  外键约束：foreign key<br>  外键字段：添加有外键约束的字段<br>  外键值：外键字段中的每一个值。</p>
</li>
<li><p>业务背景：<br>  请设计数据库表，用来维护学生和班级的信息？<br>  第一种方案：一张表存储所有数据</p>
<h2 id="no-pk-name-classno-classname"><a href="#no-pk-name-classno-classname" class="headerlink" title="  no(pk)          name          classno         classname"></a>  no(pk)          name          classno         classname</h2><p>   1               zs1            101          河南省平顶山市舞钢市垭口一高高三1班<br>   2               zs2            101          河南省平顶山市舞钢市垭口一高高三1班<br>   3               zs3            102          河南省平顶山市舞钢市垭口一高高三2班<br>   4               zs4            102          河南省平顶山市舞钢市垭口一高高三2班<br>   5               zs5            102          河南省平顶山市舞钢市垭口一高高三2班<br>   缺点：冗余。【不推荐】</p>
<p>   第二种方案：两张表(班级表和学生表)</p>
<p>   t_class 班级表</p>
<h2 id="cno-pk-cname"><a href="#cno-pk-cname" class="headerlink" title="   cno(pk)         cname"></a>   cno(pk)         cname</h2><pre><code>    101           河南省平顶山市舞钢市垭口一高高三1班 
102           河南省平顶山市舞钢市垭口一高高三2班 
  
t_student 学生表
sno(pk)        sname          classno(该字段添加外键约束fk)
-----------------------------------------------------------
 1              zs1              101
 2              zs2              101
 3              zs3              102
 4              zs4              102
 5              zs5              102
</code></pre>
</li>
<li><p>将以上表的建表语句写出来：</p>
<p>  t_student中的classno字段引用t_class表中的cno字段，此时t_student表叫做子表。t_class表叫做父表。</p>
<p>  删除数据的时候，先删除子表，再删除父表。<br>  添加数据的时候，先添加父表，再添加子表。<br>  创建表的时候，先创建父表，再创建子表。<br>  删除表的时候，先删除子表，再删除父表。</p>
</li>
</ul>
<p>   drop table if exists t_student;<br>   drop table if exists t_class;</p>
<p>   create table t_class(<br>       cno int,<br>       cname varchar(255),<br>       primary key(cno)<br>     );</p>
<pre><code>create table t_student(
    sno int,
sname varchar(255),
classno int,
primary key(sno),
foreign key(classno) references t_class(cno)
  );

insert into t_class values(101,&#39;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#39;);
insert into t_class values(102,&#39;yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy&#39;);

insert into t_student values(1,&#39;zs1&#39;,101);
insert into t_student values(2,&#39;zs2&#39;,101);
insert into t_student values(3,&#39;zs3&#39;,102);
insert into t_student values(4,&#39;zs4&#39;,102);
insert into t_student values(5,&#39;zs5&#39;,102);
insert into t_student values(6,&#39;zs6&#39;,102);
select * from t_class;
select * from t_student;

insert into t_student values(7,&#39;lisi&#39;,103);  //编译错误，引用的103，父表中没有该字段！
ERROR 1452 (23000) : Cannot add or update a child row :aforeign key constraint fails (bjpowernode INT YT......)
</code></pre>
<ul>
<li><p>外键值可以为NULL？<br>  外键可以为null。</p>
</li>
<li><p>外键字段引用其他表的某个字段的时候，被引用的字段必须是主键吗？<br>  注意：被引用的字段不一定是主键，但至少是具有unique约束，具有唯一性，不可重复！</p>
</li>
</ul>
<p>2、存储引擎？</p>
<p>   2.1、完整的建表语句<br>       CREATE TABLE <code>t_x</code> (<br>      <code>id</code> int(11) DEFAULT NULL<br>     ) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8; </p>
<pre><code> 注意：在MySQL当中，凡是标识符使用飘号括起来的。最好别用，不通用。

 建表的时候可以指定存储引擎，也可以指定字符集。

 mysql默认使用的存储引擎是InnoDB方式。
 默认采用的字符集是UTF-8。
</code></pre>
<p>   2.2、什么是存储引擎呢？<br>       存储引擎这个名字只有在mysql中存在。(Oracle中有对应的机制，但不叫做存储引擎。Oracle中没有特殊的名字，就是”表的存储方式”)</p>
<pre><code>   mysql支持很多存储引擎，每个存储引擎都对应了一种不同的存储方式。
   每一个存储引擎都有自己的优缺点，需要在合适的时机选择合适的存储引擎。
</code></pre>
<p>   2.3、查看当前mysql支持的存储引擎？<br>       show engines \G</p>
<pre><code>   mysql 5.5.36版本支持的光速引擎有9个：
 *************************** 1. row ***************************
      Engine: FEDERATED
     Support: NO
     Comment: Federated MySQL storage engine
Transactions: NULL
      XA: NULL
  Savepoints: NULL
*************************** 2. row ***************************
      Engine: MRG_MYISAM
     Support: YES
     Comment: Collection of identical MyISAM tables
Transactions: NO
      XA: NO
  Savepoints: NO
*************************** 3. row ***************************
      Engine: MyISAM
     Support: YES
     Comment: MyISAM storage engine
Transactions: NO
      XA: NO
  Savepoints: NO
*************************** 4. row ***************************
      Engine: BLACKHOLE
     Support: YES
     Comment: /dev/null storage engine (anything you write to it disappears)
Transactions: NO
      XA: NO
  Savepoints: NO
*************************** 5. row ***************************
      Engine: CSV
     Support: YES
     Comment: CSV storage engine
Transactions: NO
      XA: NO
  Savepoints: NO
*************************** 6. row ***************************
      Engine: MEMORY
     Support: YES
     Comment: Hash based, stored in memory, useful for temporary tables
Transactions: NO
      XA: NO
  Savepoints: NO
*************************** 7. row ***************************
      Engine: ARCHIVE
     Support: YES
     Comment: Archive storage engine
Transactions: NO
      XA: NO
  Savepoints: NO
*************************** 8. row ***************************
      Engine: InnoDB
     Support: DEFAULT
     Comment: Supports transactions, row-level locking, and foreign keys
Transactions: YES
      XA: YES
  Savepoints: YES
*************************** 9. row ***************************
      Engine: PERFORMANCE_SCHEMA
     Support: YES
     Comment: Performance Schema
Transactions: NO
      XA: NO
  Savepoints: NO
</code></pre>
<p>   2.4、常见的存储引擎？</p>
<pre><code>   Engine: MyISAM
     Support: YES
     Comment: MyISAM storage engine
Transactions: NO
      XA: NO
  Savepoints: NO

   MyISAM这种存储引擎不支持事务。
   MyISAM是mysql最常用的存储引擎，但是这种存储引擎不是默认的。
   MyISAM采用三个文件组织一个表：
       xxx.frm(存储格式的文件)
   xxx.MYD(存储表中数据的文件)
   xxx.MYI(存储表中索引的文件)
   优点：可被压缩，节省存储空间。并且可以转换为只读表，提高检索效率。
   缺点:不支持事务。
</code></pre>
<hr>
<pre><code>       Engine: InnoDB
     Support: DEFAULT
     Comment: Supports transactions, row-level locking, and foreign keys
Transactions: YES
      XA: YES
  Savepoints: YES
   
   优点：支持事务、行级锁、外键等。这种存储引擎数据的安全得到保障。

   表的结构存储在xxx.frm文件中
   数据存储在tablespace这样的表空间中(逻辑概念)，无法被压缩，无法转换成只读。
   这种InnoDB存储引擎在MySQL数据库崩溃之后提供自动恢复机制。
   InoDB支持级联删除和级联更新。

----------------------------------------------------------------------------------

       Engine: MEMORY
     Support: YES
     Comment: Hash based, stored in memory, useful for temporary tables
Transactions: NO
      XA: NO
  Savepoints: NO

  缺点：不支持事务。数据容易丢失。因为所有数据和索引都是存储在内存当中的。
  优点：查询速度最快。
  以前叫做HEPA引擎。
</code></pre>
<p>3、事务(Transaction)</p>
<p>   3.1、什么是事务？</p>
<pre><code>   一个事务是一个完整的业务逻辑单元，不可再分。

   比如：银行账户，从A账户向B账户转账10000元，需要执行两条update语句。
       update t_act set balance = balance - 10000 where actno = &#39;act-001&#39;;
   update t_act set balance = balance + 10000 where actno = &#39;act-002&#39;;

   以上两条DML语句必须同时成功，或者同时失败，不允许出现一条成功，一条失败。

   想要保证以上的两条DML语句同时成功或者同时失败，那么就要使用数据库的&quot;事务机制&quot;。
</code></pre>
<p>   3.2、和事务相关的语句只有：DML语句。(insert delete update)<br>       为什么？因为他们这三个语句都是和数据库表当中的”数据”相关的。<br>       事务的存在是为了保证数据的完整性，安全性。</p>
<p>   3.3、假设所有的业务都能使用1条DML语句搞定，还需要事务机制吗？<br>       不需要事务机制。<br>       但实际情况不是这样的，通常一个”事儿(事务【业务】)”需要多条DML语句共同联合完成。</p>
<p>   3.4、事务的特性？<br>       事务包括四大特性：ACID<br>    A:原子性：事务是最小的工作单元，不可再分。<br>    B:一致性：事务必须保证多条DML语句同时成功或者同时失败。<br>    C:隔离性：事务A与事务B之间具有隔离。<br>    D:持久性：持久性说的是最终数据必须持久化到硬盘中，事务才算成功结束。</p>
<p>   3.5、关于事务之间的隔离性？<br>       事务隔离性存在隔离级别，理论上隔离级别包括4个：<br>           第一级别：读未提交(read uncommitted)<br>           对方事务还没有提交，我们当前事务可以读取到对方未提交的数据。<br>           读未提交存在脏读(Dirty Read) 现象：表示读到了脏数据。<br>       第二级别：读已提交(read committed)<br>           对方事务提交之后的数据我方可以读取到。<br>           读已提交存在的问题是：不可重复读。<br>       第三级别：可重复读(repeatable read)<br>           这种隔离级别解决了：不可重复读问题。<br>           这种隔离级别存在的问题是：读取到的数据是幻象。<br>       第四级别：序列化读&#x2F;串行化读<br>           解决了所有问题。<br>           效率低，需要事务排队。</p>
<pre><code>   Oracle数据库默认的隔离级别是：第二级别，读已提交。
   mysql数据库默认的隔离级别是：第三级别，可重复读。
</code></pre>
<p>   3.6、演示事务：<br>       * mysql事务默认情况下是自动提交的。<br>           (什么是自动提交？只要执行任意一条DML语句则提交一次。)怎么关闭默认提交？start transaction;</p>
<pre><code>   * 建表：
       drop table if exists t_user;
   create table t_user(
       id int primary key auto_increment,
       username varchar(255)
     );

   * 演示：mysql中的事务是支持自动提交的，只要执行一条DML语句，则提交一次。
       mysql&gt; insert into t_user(username) values(&#39;zs&#39;);
   Querk OK, 1 row affected (0.03 sec)
   mysql&gt; select * from t_user;
    +----+----------+
    | id | username |
    +----+----------+
    |  1 | zs       |
    +----+----------+
   mysql&gt; rollback;
   Query OK, 0 rows affected (0.00 sec)

       mysql&gt; select * from t_user;
     +----+----------+
     | id | username |
     +----+----------+
     |  1 | zs       |
     +----+----------+

* 演示：使用start transaction; 关闭自动提交机制。
    mysql&gt; select * from t_user;
    +----+----------+
    | id | username |
    +----+----------+
    |  1 | zs       |
    +----+----------+
    1 row in set (0.00 sec)

    mysql&gt; start transaction;
    Query OK, 0 rows affected (0.00 sec)

    mysql&gt; insert into t_user(username) values(&quot;lisi&quot;);
    Query OK, 1 row affected (0.00 sec)

    mysql&gt; select * from t_user;
    +----+----------+
    | id | username |
    +----+----------+
    |  1 | zs       |
    |  2 | lisi     |
    +----+----------+
    2 rows in set (0.00 sec)

    mysql&gt; insert into t_user(username) values(&quot;wangwu&quot;);
    Query OK, 1 row affected (0.00 sec)

    mysql&gt; select * from t_user;
    +----+----------+
    | id | username |
    +----+----------+
    |  1 | zs       |
    |  2 | lisi     |
    |  3 | wangwu   |
    +----+----------+
    3 rows in set (0.00 sec)

    mysql&gt; rollback;    //回滚
    Query OK, 0 rows affected (0.00 sec)

    mysql&gt; select * from t_user;
    +----+----------+
    | id | username |
    +----+----------+
    |  1 | zs       |
    +----+----------+
    1 row in set (0.00 sec)

    mysql&gt; start transaction;
    Query OK, 0 rows affected (0.00 sec)

    mysql&gt; insert into t_user(username) values(&quot;wangwu&quot;);
    Query OK, 1 row affected (0.00 sec)

    mysql&gt; insert into t_user(username) values(&quot;object&quot;);
    Query OK, 1 row affected (0.00 sec)

    mysql&gt; insert into t_user(username) values(&quot;joke&quot;);
    Query OK, 1 row affected (0.00 sec)

    mysql&gt; insert into t_user(username) values(&quot;xiaozhaozhao&quot;);
    Query OK, 1 row affected (0.00 sec)

    mysql&gt; select * from t_user;
    +----+--------------+
    | id | username     |
    +----+--------------+
    |  1 | zs           |
    |  4 | wangwu       |
    |  5 | object       |
    |  6 | joke         |
    |  7 | xiaozhaozhao |
    +----+--------------+
    5 rows in set (0.00 sec)

    mysql&gt; commit;
    Query OK, 0 rows affected (0.00 sec)

    mysql&gt; select * from t_user;
    +----+--------------+
    | id | username     |
    +----+--------------+
    |  1 | zs           |
    |  4 | wangwu       |
    |  5 | object       |
    |  6 | joke         |
    |  7 | xiaozhaozhao |
    +----+--------------+
    5 rows in set (0.00 sec)

    mysql&gt; rollback;
    Query OK, 0 rows affected (0.00 sec)

    mysql&gt; select * from t_user;
    +----+--------------+
    | id | username     |
    +----+--------------+
    |  1 | zs           |
    |  4 | wangwu       |
    |  5 | object       |
    |  6 | joke         |
    |  7 | xiaozhaozhao |
    +----+--------------+
    5 rows in set (0.00 sec)

rollback : 回滚。
commit ： 提交。
start transaction : 关闭自动提交机制。
 
  -----------------------------------------------------------------
</code></pre>
<ul>
<li>演示两个事务，假如隔离级别：<br>  演示第1级别：读未提交<br>  set global transaction isolation level read uncommitted;<br>  演示第二级别；读已提交<br>  set global transaction isolation level read committed;<br>  演示第三级别:可重复读<br>  set global transaction isolation level repeatable read;</li>
</ul>
<p>   *mysql远程登录：mysql -h192.168.151.18 -uroot -p444</p>
<p>4、索引<br>    4.1、什么是索引？有什么用？<br>        索引就相当于一本书的目录，通过目录可以快速的找到对应的资源。<br>    在数据库方面，查询一张表的时候有两种检索方式：<br>        第一种方式：全表扫描<br>        第二种方式：根据索引检索(效率很高)<br>    索引为什么可以提高检索效率呢？<br>        其实最根本的原理是缩小了扫描的范围。</p>
<pre><code>索引虽然可以提高检索效率，但是不能随意的添加索引，因为索引也是数据库当中的对象，也需要数据库不断的维护。是有维护成本的。
比如：表中的数据经常被修改，这样就不适合添加索引，因为数据一旦修改，索引需要重新排序，进行维护。

添加索引是给某一个字段，或者说某些字段添加索引。

select ename,sal from emp where ename = &#39;SMITH&#39;;
当ename字段没有添加索引的时候，以上sql语句会进行全表扫描，扫描ename字段中所有的值。
当ename字段添加索引的时候，以上sql语句会根据索引扫描，快速定位。
</code></pre>
<p>   4.2、怎么创建索引对象？怎么删除索引对象？<br>    创建索引对象：<br>        create index 索引名称 on 表名(字段名);<br>    删除索引对象：<br>        drop index 索引名称 on 表名;</p>
<p>   4.3、什么时候考虑给字段添加索引？(满足什么条件)<br>       * 数据量庞大。(根据客户的需求，根据线上的环境)<br>       * 该字段很少的DML操作。(因为字段进行修改操作，索引也需要维护)<br>       * 该字段经常出现在where子句中。(经常根据哪个字段维护)</p>
<p>   4.4、注意：主键具有unique约束的字段会自动添加索引。<br>       根据主键查询效率较高，尽量根据主键检索。</p>
<p>   4.5、查看sql语句的执行计划：<br>       mysql&gt; explain select ename,sal from emp where sal &#x3D; 5000;<br>+—-+————-+——-+——+—————+——+———+——+——+————-+<br>| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra       |<br>+—-+————-+——-+——+—————+——+———+——+——+————-+<br>|  1 | SIMPLE      | emp   | ALL  | NULL          | NULL | NULL    | NULL |   14 | Using where |<br>+—-+————-+——-+——+—————+——+———+——+——+————-+</p>
<pre><code>给薪资sal字段添加索引：
    create index emp_sal_index on emp(sal);
</code></pre>
<p>   mysql&gt; explain select ename,sal from emp where sal &#x3D; 5000;<br>+—-+————-+——-+——+—————+—————+———+——-+——+————-+<br>| id | select_type | table | type | possible_keys | key           | key_len | ref   | rows | Extra       |<br>+—-+————-+——-+——+—————+—————+———+——-+——+————-+<br>|  1 | SIMPLE      | emp   | ref  | emp_sal_index | emp_sal_index | 9       | const |    1 | Using where |<br>+—-+————-+——-+——+—————+—————+———+——-+——+————-+<br>                                                                                  rows检索次数减少了</p>
<p>   4.6、索引底层采用的数据结构是：B + Tree</p>
<p>   4.7、索引的实现原理？<br>       通过B Tree缩小扫描范围，底层索引进行了排序，分区，索引会携带数据在表中的”物理地址”，最终通过索引检索到数据之后，获取到关联的物理地址，<br>       通过物理索引检索到数据之后，获取到关联的物理地址，通过物理地址定位表中的数据，效率是最高的。<br>           select ename from emp where ename &#x3D; ‘SMITH’;<br>       通过索引转换为：<br>       select ename from emp where  物理地址 &#x3D; 0x123;</p>
<p>   4.8、索引的分类？<br>       单一索引：给单个字段添加索引<br>       复合索引：给多个字段联合起来添加一个索引<br>       主键索引：主键上会自动添加索引<br>       唯一索引：有unique约束的字段会自动添加索引<br>       ……</p>
<p>   4.9、索引什么时候失效？<br>       select ename from emp where ename like ‘ %A% ‘;<br>       模糊查询的时候，第一个通配符使用的是%，这个时候索引是是失效的。</p>
<p>5、试图(view)</p>
<pre><code>5.1、什么是视图？
   站在不同的角度去看到数据。(同一张表的数据，通过不同的角度去看待)

5.2、怎么创建视图？怎么删除视图？
create view myview as select empno,ename from emp;
drop view myview;

注意：只有DQL语句才能以试图对象的方式创建出来。

5.3、对试图进行增删改查，会影响到原表数据。(通过视图影响原表数据，不是直接操作的原表)
可以对试图进行CRUD操作。

5.4、面向视图操作？
mysql&gt; select * from myview;
+-------+--------+
| empno | ename  |
+-------+--------+
|  7369 | SMITH  |
|  7499 | ALLEN  |
|  7521 | WARD   |
|  7566 | JONES  |
|  7654 | MARTIN |
|  7698 | BLAKE  |
|  7782 | CLARK  |
|  7788 | SCOTT  |
|  7839 | KING   |
|  7844 | TURNER |
|  7876 | ADAMS  |
|  7900 | JAMES  |
|  7902 | FORD   |
|  7934 | MILLER |
+-------+--------+

  create table emp_bak as select * from emp;
  create view myview1 as select empno,ename,sal from emp_bak;
  update myview1 set ename = &#39;hehe&#39;,sal = 1 where empno 7369;  //通过视图修改原表数据。
  delete from myview1 where empno = 7369;  //通过试图删除原表数据。
</code></pre>
<p>   5.5、试图的作用？<br>       试图可以隐藏表的实现细节。保密级别较高的系统，数据库只对外提供相关的视图，java程序员只对视图对象进行CRUD。</p>
<p>6、DBA命令</p>
<pre><code>6.1、在数据库当中的数据导出
    在windows的DOS命令窗口中执行： (导出整个库)
    mysqldump bjpowernode&gt;D:\bjpowernode.sql -uroot -p999
在windows的dos命令窗口中执行：(导出数据库中指定的表)
    mysqldump bjpowernode emp&gt;D:\bjpowernode.sql -uroot -p999

6.2、导入数据
    create database bjpowernode;
use bjpowernode;
source D:\bjpowernode.sql 
</code></pre>
<p>7、数据库设计三范式(重点内容，面试经常会问)</p>
<pre><code>7.1、什么是设计范式？
    设计表的依据。按照这三个范式设计的表不会出现数据冗余。

7.2、三范式都是哪些？
    第一范式：任何一张表都应该有主键，并且每一个字段原子性不可再分。

第二范式：建立在第一范式的基础上，所有非主键字段完全依赖主键，不能产生部份依赖。
    多对多？三张表，关系表两个外键。
    t_student学生表
    sno(pk)       sname
    ---------------------
     1             张三
     2             李四 
     3             王五

     t_teacher 讲师表
     tno(pk)            tname
     ----------------------
      1			王老师
      2			张老师
      3			李老师

      t_student_teacher_relation 学生讲师关系表
      id(pk)        sno(fk)          tno(fk)
      -------------------------------------------
       1	      1                 3
       2	      1			1
       3	      2			2
       4	      2			3
       5	      3			1
       6	      3			3
 
第三范式：建立在第二范式的基础上，所有非主键字段直接依赖主键，不能产生传递依赖。
    一对多？两张表，多的表加外键。
    班级t_class
    cno(pk)          cname
    --------------------------
      1              班级1
      2              班级2

    学生t_student
    sno(pk)         sname         classno(fk)
    --------------------------------------------
     101	     张1	      1
     102             张2	      2
     103	     张3	      2
     104	     张4	      1
     105	     张5	      2

  提醒：在实际的开发中，以满足客户需求为主，有的时候会拿冗余换执行速度。
</code></pre>
<p>   7.3、一对一怎么设计？</p>
<p>  一对一设计有两种方案：主键共享<br>   t_user_login 用户登陆表<br>    id(pk)       username        password<br>    —————————————-<br>     1             zs                123<br>     2             ls                456</p>
<pre><code> t_user_detail 用户详细信息表
  id(pk+fk)         realname          tel          ...
 ----------------------------------------------------
    1              张三            11111111112234
2	       李四            12112523432412
</code></pre>
<p>  一对一设计有两种方案:外键唯一。<br>   t_user_login 用户登陆表<br>    id(pk)       username        password<br>    —————————————-<br>     1             zs                123<br>     2             ls                456</p>
<pre><code> t_user_detail 用户详细信息表
  id(pk)         realname          tel            userid(fk+unique)      
 ----------------------------------------------------
   1                张三         111111114          2
   2	        李四         121432412          1
</code></pre>

        <!-- 分类文章 -->
        
          <div class="post-categoris-bottom">
            <div class="post-categoris-name">数据库</div>
            <ul>
            
            
              
            
            
            
            
            
              
                <li class="base">
                  <a  href="/GaoHangIdea/2022/10/19/MySQL%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0-day01/" class="post-categoris-bottom-link">
                  Mysql1
                </a>
                </li>
              
              
            
            
            
              
                <li class="base">
                  <a  href="/GaoHangIdea/2022/10/19/MySQL%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0-day02/" class="post-categoris-bottom-link">
                  Mysql2
                </a>
                </li>
              
              
            
            
            
              
                <li class="me base">
                  <a  href="/GaoHangIdea/2022/10/19/MySQL%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0-day03/" class="post-categoris-bottom-link">
                  Mysql3
                </a>
                </li>
              
              
            
            
            
            
            
            
            
              
            
            
            
            
            </ul>

          </div>

        
      </div>
      <div class="post-content-inner-space">
        
          <div class="space-toc-main animate__animated  animate__fadeInUp">
            <ol class="space-toc"><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#no-pk-name-classno-classname"><span class="space-toc-text">  no(pk)          name          classno         classname</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#cno-pk-cname"><span class="space-toc-text">   cno(pk)         cname</span></a></li></ol>
           </div>
        
      </div>
   </div>
    <!-- 评论 -->
    
  </div>
</article>
  </div>
</div>



<!-- 如果是home模式的话，不在首页就显示footer，如果不是home模式的话 所有都显示footer -->

  <div class="footer-outer animate__animated  animate__fadeInUp">
    <div class="footer-inner">
    <div class="footer-text">
    <p>If you don&#96;t want anything, you will return with a full load !</p>

    </div>
    <div class="footer-contact">
    <ul class="footer-ul">
        
        <li class="footer-li">
            <a href="https://github.com/godgaohhh/GaoHangIdea" target="_blank">
                <i class="ri-github-line"></i>
            </a>
        </li>
        
        <li class="footer-li">
            <a href="mailto:GaoHangde01@outlook.com" target="_blank">
                <i class="ri-mail-line"></i>
            </a>
        </li>
        
    </ul>
    </div>
    </div>
</div>






<script src="/GaoHangIdea/js/white.js"></script>



    
      
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

      <script>hljs.initHighlightingOnLoad();</script>
    

</body>
</html>
